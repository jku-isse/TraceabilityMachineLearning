private static JSheet createSheet(final JOptionPane pane, Component parentComponent, int style) {
    Window window = JSheet.getWindowForComponent(parentComponent);
    final JSheet sheet;
    if (window instanceof Frame) {
        sheet = new JSheet(((Frame) (window)));
    } else {
        sheet = new JSheet(((Dialog) (window)));
    }
    JComponent contentPane = ((JComponent) (sheet.getContentPane()));
    contentPane.setLayout(new BorderLayout());
    if (JSheet.isNativeSheetSupported()) {
        contentPane.setBorder(new EmptyBorder(12, 0, 0, 0));
    }
    contentPane.add(pane, BorderLayout.CENTER);
    sheet.setResizable(false);
    sheet.addWindowListener(new WindowAdapter() {
        private boolean gotFocus = false;

        int count;

        public void windowClosing(WindowEvent we) {
            pane.setValue(null);
        }

        public void windowClosed(WindowEvent we) {
            if ((pane.getValue()) == (JOptionPane.UNINITIALIZED_VALUE)) {
                sheet.fireOptionSelected(pane);
            }
        }

        public void windowGainedFocus(WindowEvent we) {
            // Once window gets focus, set initial focus
            if (!(gotFocus)) {
                // Ugly dirty hack: JOptionPane.selectInitialValue() is protected.
                // So we call directly into the UI. This may cause mayhem,
                // because we override the encapsulation.
                // pane.selectInitialValue();
                OptionPaneUI ui = pane.getUI();
                if (ui != null) {
                    ui.selectInitialValue(pane);
                }
                gotFocus = true;
            }
        }
    });
    sheet.addComponentListener(new ComponentAdapter() {
        public void componentShown(ComponentEvent ce) {
            // reset value to ensure closing works properly
            pane.setValue(JOptionPane.UNINITIALIZED_VALUE);
        }
    });
    pane.addPropertyChangeListener(new PropertyChangeListener() {
        public void propertyChange(PropertyChangeEvent event) {
            // Let the defaultCloseOperation handle the closing
            // if the user closed the window without selecting a button
            // (newValue = null in that case).  Otherwise, close the sheet.
            if (((((sheet.isVisible()) && ((event.getSource()) == pane)) && (event.getPropertyName().equals(JOptionPane.VALUE_PROPERTY))) && ((event.getNewValue()) != null)) && ((event.getNewValue()) != (JOptionPane.UNINITIALIZED_VALUE))) {
                sheet.setVisible(false);
                sheet.fireOptionSelected(pane);
            }
        }
    });
    sheet.pack();
    return sheet;
}