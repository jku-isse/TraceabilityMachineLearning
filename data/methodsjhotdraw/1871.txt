public int printPage(Graphics graphics, PageFormat pageFormat, int pageIndex) throws PrinterException {
    if ((pageIndex < 0) || (pageIndex >= (getNumberOfPages()))) {
        return Printable.NO_SUCH_PAGE;
    }
    if ((drawing.getChildCount()) > 0) {
        Graphics2D g = ((Graphics2D) (graphics));
        setRenderingHints(g);
        // Determine the draw bounds of the drawing
        Rectangle2D.Double drawBounds = null;
        for (Figure f : drawing.getChildren()) {
            if (drawBounds == null) {
                drawBounds = f.getDrawingArea();
            } else {
                drawBounds.add(f.getDrawingArea());
            }
        }
        // Setup a transformation for the drawing
        AffineTransform tx = new AffineTransform();
        tx.translate(pageFormat.getImageableX(), pageFormat.getImageableY());
        // Maybe rotate drawing
        if (((isAutorotate) && ((drawBounds.width) > (drawBounds.height))) && ((pageFormat.getImageableWidth()) < (pageFormat.getImageableHeight()))) {
            double scaleFactor = Math.min(((pageFormat.getImageableWidth()) / (drawBounds.height)), ((pageFormat.getImageableHeight()) / (drawBounds.width)));
            tx.scale(scaleFactor, scaleFactor);
            tx.translate(drawBounds.height, 0.0);
            tx.rotate(((Math.PI) / 2.0), 0, 0);
            tx.translate((-(drawBounds.x)), (-(drawBounds.y)));
        } else {
            double scaleFactor = Math.min(((pageFormat.getImageableWidth()) / (drawBounds.width)), ((pageFormat.getImageableHeight()) / (drawBounds.height)));
            tx.scale(scaleFactor, scaleFactor);
            tx.translate((-(drawBounds.x)), (-(drawBounds.y)));
        }
        g.transform(tx);
        // Draw the drawing
        drawing.draw(g);
    }
    return Printable.PAGE_EXISTS;
}