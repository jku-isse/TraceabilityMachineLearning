protected JFileChooser createExportChooser() {
    JFileChooser c = new JFileChooser();
    fileFilterOutputFormatMap = new HashMap<FileFilter, OutputFormat>();
    // c.addChoosableFileFilter(new ExtensionFileFilter("SVG Drawing","svg"));
    FileFilter currentFilter = null;
    for (OutputFormat format : svgPanel.getDrawing().getOutputFormats()) {
        FileFilter ff = format.getFileFilter();
        fileFilterOutputFormatMap.put(ff, format);
        c.addChoosableFileFilter(ff);
        if (ff.getDescription().equals(preferences.get("viewExportFormat", ""))) {
            currentFilter = ff;
        }
    }
    if (currentFilter != null) {
        c.setFileFilter(currentFilter);
    }
    c.setSelectedFile(new File(preferences.get("viewExportFile", System.getProperty("user.home"))));
    return c;
}