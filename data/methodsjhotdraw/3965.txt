public Object getTransferData(DataFlavor flavor) throws UnsupportedFlavorException, IOException {
    /* if (! isDataFlavorSupported(flavor)) {
    throw new UnsupportedFlavorException(flavor);
    }
     */
    if (flavor.equals(DataFlavor.imageFlavor)) {
        return image;
    } else
        if (flavor.equals(ImageTransferable.IMAGE_PNG_FLAVOR)) {
            ByteArrayOutputStream buf = new ByteArrayOutputStream();
            ImageIO.write(Images.toBufferedImage(image), "PNG", buf);
            return new ByteArrayInputStream(buf.toByteArray());
        } else {
            throw new UnsupportedFlavorException(flavor);
        }

}