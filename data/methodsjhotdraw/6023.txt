protected IXMLElement createRect(IXMLElement doc, double x, double y, double width, double height, double rx, double ry, Map<AttributeKey, Object> attributes) throws IOException {
    IXMLElement elem = doc.createElement("rect");
    writeAttribute(elem, "x", x, 0.0);
    writeAttribute(elem, "y", y, 0.0);
    writeAttribute(elem, "width", width, 0.0);
    writeAttribute(elem, "height", height, 0.0);
    writeAttribute(elem, "rx", rx, 0.0);
    writeAttribute(elem, "ry", ry, 0.0);
    writeShapeAttributes(elem, attributes);
    writeOpacityAttribute(elem, attributes);
    writeTransformAttribute(elem, attributes);
    return elem;
}