protected IXMLElement createLinearGradient(IXMLElement doc, double x1, double y1, double x2, double y2, double[] stopOffsets, Color[] stopColors, double[] stopOpacities, boolean isRelativeToFigureBounds, AffineTransform transform) throws IOException {
    IXMLElement elem = doc.createElement("linearGradient");
    writeAttribute(elem, "x1", SVGOutputFormat.toNumber(x1), "0");
    writeAttribute(elem, "y1", SVGOutputFormat.toNumber(y1), "0");
    writeAttribute(elem, "x2", SVGOutputFormat.toNumber(x2), "1");
    writeAttribute(elem, "y2", SVGOutputFormat.toNumber(y2), "0");
    writeAttribute(elem, "gradientUnits", (isRelativeToFigureBounds ? "objectBoundingBox" : "userSpaceOnUse"), "objectBoundingBox");
    writeAttribute(elem, "gradientTransform", SVGOutputFormat.toTransform(transform), "none");
    for (int i = 0; i < (stopOffsets.length); i++) {
        IXMLElement stop = new XMLElement("stop");
        writeAttribute(stop, "offset", SVGOutputFormat.toNumber(stopOffsets[i]), null);
        writeAttribute(stop, "stop-color", SVGOutputFormat.toColor(stopColors[i]), null);
        writeAttribute(stop, "stop-opacity", SVGOutputFormat.toNumber(stopOpacities[i]), "1");
        elem.addChild(stop);
    }
    return elem;
}