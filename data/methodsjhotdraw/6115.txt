/**
 * Accessor for text area.
 * This is used by Actions that need ot act on the text area of the View.
 */
public int getLineOfOffset(int offset) throws BadLocationException {
    // return editor.getLineOfOffset(offset);
    Document doc = getDocument();
    if (offset < 0) {
        throw new BadLocationException("Cant translate offset to line", (-1));
    } else
        if (offset > (doc.getLength())) {
            throw new BadLocationException("Cant translate offset to line", ((doc.getLength()) + 1));
        } else {
            Element map = getDocument().getDefaultRootElement();
            return map.getElementIndex(offset);
        }

}