/**
 * Return the selected node
 */
private DefaultMutableTreeNode getSelectedTaskNode() {
    TreePath currentSelection = treetable.getTree().getSelectionPath();
    if ((currentSelection == null) || (!((currentSelection.getLastPathComponent()) instanceof TaskNode))) {
        return null;
    }
    DefaultMutableTreeNode dmtnselected = ((DefaultMutableTreeNode) (currentSelection.getLastPathComponent()));
    return dmtnselected;
}