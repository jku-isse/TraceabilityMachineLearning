public void previewPrint() {
    Date startDate;
    Date endDate;
    Chart chart = getUIFacade().getActiveChart();
    if (chart == null) {
        getUIFacade().showErrorDialog("Failed to find active chart.
Please report this problem to GanttProject development team");
        return;
    }
    try {
        startDate = chart.getStartDate();
        endDate = chart.getEndDate();
    } catch (UnsupportedOperationException e) {
        startDate = null;
        endDate = null;
    }
    if ((getTabs().getSelectedIndex()) == (UIFacade.GANTT_INDEX)) {
        startDate = area.getChartModel().getStartDate();
        endDate = area.getChartModel().getEndDate();
    } else
        if ((getTabs().getSelectedIndex()) == (UIFacade.RESOURCES_INDEX)) {
            startDate = getResourcePanel().area.getChartModel().getStartDate();
            endDate = getResourcePanel().area.getChartModel().getEndDate();
        }

    try {
        PrintPreview preview = new PrintPreview(getProject(), getUIFacade(), chart, startDate, endDate);
        if (preview != null)
            preview.setVisible(true);

    } catch (OutOfMemoryError e) {
        getUIFacade().showErrorDialog(GanttLanguage.getInstance().getText("printing.out_of_memory"));
        return;
    }
}