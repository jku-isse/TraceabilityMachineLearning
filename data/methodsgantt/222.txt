public RenderedImage getRenderedImage(GanttExportSettings settings) {
    Date dateStart = null;
    Date dateEnd = null;
    List myItemsToConsider = myTaskImageGenerator.getPrintableNodes(settings);
    TimeUnit unit = getViewState().getBottomTimeUnit();
    dateStart = ((settings.getStartDate()) == null) ? getStartDate() : settings.getStartDate();
    dateEnd = ((settings.getEndDate()) == null) ? getEndDate() : settings.getEndDate();
    // dateStart = new GregorianCalendar(2005,2,25).getTime();
    if (dateStart.after(dateEnd)) {
        Date tmp = ((Date) (dateStart.clone()));
        dateStart = ((Date) (dateEnd.clone()));
        dateEnd = tmp;
    }
    // System.out.println("GanttGraphicArea dateStart=" + dateStart);
    // System.out.println("GanttGraphicArea dateEnd=" + dateEnd);
    TaskLength printedLength = getTaskManager().createLength(unit, dateStart, dateEnd);
    BufferedImage taskImage = ((BufferedImage) (myTaskImageGenerator.createImage(myItemsToConsider)));
    int chartWidth = ((int) (((printedLength.getLength(getViewState().getBottomTimeUnit())) + 1) * (getViewState().getBottomUnitWidth())));
    if (chartWidth < (getWidth())) {
        chartWidth = getWidth();
    }
    int chartHeight = taskImage.getHeight(null);
    return new RenderedGanttChartImage(myChartModel, myChartComponentImpl, GanttTree2.convertNodesListToItemList(myItemsToConsider), taskImage, chartWidth, chartHeight);
}