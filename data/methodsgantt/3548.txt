void save(IGanttProject project, TransformerHandler handler, Color defaultColor) throws IOException, SAXException {
    AttributesImpl attrs = new AttributesImpl();
    if (defaultColor != null) {
        addAttribute("color", ColorConvertion.getColor(defaultColor), attrs);
    }
    startElement("tasks", attrs, handler);
    startElement("taskproperties", handler);
    writeTaskProperties(handler, project.getCustomColumnsStorage());
    endElement("taskproperties", handler);
    Task rootTask = project.getTaskManager().getTaskHierarchy().getRootTask();
    Task[] tasks = project.getTaskManager().getTaskHierarchy().getNestedTasks(rootTask);
    for (int i = 0; i < (tasks.length); i++) {
        writeTask(handler, ((GanttTask) (tasks[i])), project.getCustomColumnsStorage());
    }
    endElement("tasks", handler);
}