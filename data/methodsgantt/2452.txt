void visit(Task task, int depth, StringBuffer out) throws Exception {
    Task[] nestedTasks = task.getManager().getTaskHierarchy().getNestedTasks(task);
    for (int i = 0; i < (nestedTasks.length); i++) {
        Task next = nestedTasks[i];
        String nextSerialized = serializeTask(next, depth);
        out.append(nextSerialized);
        visit(next, (depth + 1), out);
    }
}