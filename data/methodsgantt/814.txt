// update 21/03/2003
/**
 * Refresh the expantion (recursive function)
 */
public void expandRefresh(DefaultMutableTreeNode moved) {
    if (moved instanceof TaskNode) {
        Task movedTask = ((Task) (moved.getUserObject()));
        // if (expand.contains(new Integer(movedTask.getTaskID()))) {
        if (movedTask.getExpand())
            treetable.getTree().expandPath(new TreePath(moved.getPath()));

        Enumeration children = moved.children();
        while (children.hasMoreElements()) {
            expandRefresh(((DefaultMutableTreeNode) (children.nextElement())));
        } 
    }
}