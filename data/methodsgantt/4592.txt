private void recalculateSupertaskCompletionPercentage(Task task, TaskContainmentHierarchyFacade facade) {
    Task[] nestedTasks = facade.getNestedTasks(task);
    if ((nestedTasks.length) > 0) {
        int completedDays = 0;
        long plannedDays = 0;
        for (int i = 0; i < (nestedTasks.length); i++) {
            Task next = nestedTasks[i];
            long nextDuration = next.getDuration().getLength();
            completedDays += nextDuration * (next.getCompletionPercentage());
            plannedDays += nextDuration;
        }
        int completionPercentage = ((int) (completedDays / plannedDays));
        task.setCompletionPercentage(completionPercentage);
    }
}