private Dimension calculateDimension() {
    int width = 0;
    int assignmentsCount = 0;
    final BufferedImage testImage = new BufferedImage(10, 10, BufferedImage.TYPE_INT_RGB);
    final Graphics g = testImage.getGraphics();
    final int tabSize = 5;
    final List users = myResourceManager.getResources();
    for (Iterator user = users.iterator(); user.hasNext();) {
        HumanResource hr = ((HumanResource) (user.next()));
        int nameWidth = TextLengthCalculatorImpl.getTextLength(g, hr.getName());
        if (nameWidth > width) {
            width = nameWidth;
        }
        ResourceAssignment[] assignments = hr.getAssignments();
        if (assignments != null) {
            for (int i = 0; i < (assignments.length); i++) {
                if (isAssignmentVisible(assignments[i])) {
                    int taskWidth = tabSize + (TextLengthCalculatorImpl.getTextLength(g, assignments[i].getTask().getName()));
                    if (taskWidth > width) {
                        width = taskWidth;
                    }
                    assignmentsCount++;
                }
            }
        }
    }
    width += 20;
    int height = ((assignmentsCount + (users.size())) * (getRowHeight())) + 90;
    return new Dimension(width, height);
}