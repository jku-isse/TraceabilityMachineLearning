/**
 * Inserts the string <code>str</code> into the document if it matches
 * with the valid characters.
 *
 * @param offs
 * 		Offset for the insertion.
 * @param str
 * 		String to insert.
 * @param a
 * 		AttibutSet.
 * @throws BadLocationException
 * 		
 */
public void insertString(int offs, String str, AttributeSet a) throws BadLocationException {
    if ((this.pattern) != null) {
        String s = this.getText(0, this.getLength());
        Matcher m = this.pattern.matcher((s + str));
        if (m.matches())
            super.insertString(offs, str, a);

    } else {
        // //
        StringBuffer sb = new StringBuffer();
        for (int i = 0; i < (str.length()); i++)
            if (((this.valid_characters) == null) || ((this.valid_characters.indexOf(str.charAt(i))) != (-1)))
                sb.append(str.charAt(i));
            else
                Toolkit.getDefaultToolkit().beep();


        super.insertString(offs, sb.toString(), a);
    }
}