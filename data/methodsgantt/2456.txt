private Job createTransferJob(URL baseUrl, final File file) throws IOException {
    final URL outUrl = new URL(baseUrl, file.getName());
    Job result = new Job(("transfer file " + (file.getName()))) {
        protected IStatus run(IProgressMonitor monitor) {
            byte[] buffer = new byte[((int) (file.length()))];
            FileInputStream inputStream = null;
            OutputStream outStream = null;
            try {
                inputStream = new FileInputStream(file);
                inputStream.read(buffer);
                GPLogger.log(("writing to file=" + outUrl));
                outStream = outUrl.openConnection().getOutputStream();
                outStream.write(buffer);
                outStream.flush();
                monitor.worked(1);
                return Status.OK_STATUS;
            } catch (IOException e) {
                if (!(GPLogger.log(e))) {
                    e.printStackTrace(System.err);
                }
                return Status.CANCEL_STATUS;
            } finally {
                if (inputStream != null) {
                    try {
                        inputStream.close();
                    } catch (IOException e) {
                        if (!(GPLogger.log(e))) {
                            e.printStackTrace(System.err);
                        }
                    }
                }
                if (outStream != null) {
                    try {
                        outStream.close();
                    } catch (IOException e) {
                        if (!(GPLogger.log(e))) {
                            e.printStackTrace(System.err);
                        }
                    }
                }
            }
        }
    };
    return result;
}