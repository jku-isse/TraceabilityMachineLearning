protected void openDocument(GanttProject targetProject, IGanttProject bufferProject, UIFacade uiFacade, File selectedFile, boolean bMerge) {
    try {
        Document document = bufferProject.getDocumentManager().getDocument(selectedFile.getAbsolutePath());
        document.read();
        targetProject.getRoleManager().importData(bufferProject.getRoleManager());
        {
            CustomPropertyManager targetResCustomPropertyMgr = targetProject.getResourceCustomPropertyManager();
            targetResCustomPropertyMgr.importData(bufferProject.getResourceCustomPropertyManager());
        }
        Map original2ImportedResource = targetProject.getHumanResourceManager().importData(bufferProject.getHumanResourceManager());
        {
            CustomColumnsStorage targetCustomColumnStorage = targetProject.getCustomColumnsStorage();
            targetCustomColumnStorage.importData(bufferProject.getCustomColumnsStorage());
        }
        TaskManagerImpl origTaskManager = ((TaskManagerImpl) (targetProject.getTaskManager()));
        try {
            origTaskManager.setEventsEnabled(false);
            Map original2ImportedTask = origTaskManager.importData(bufferProject.getTaskManager());
            origTaskManager.importAssignments(bufferProject.getTaskManager(), targetProject.getHumanResourceManager(), original2ImportedTask, original2ImportedResource);
        } finally {
            origTaskManager.setEventsEnabled(true);
        }
        targetProject.getResourcePanel().getResourceTreeTableModel().updateResources();
        /* TaskManager taskManager = bufferProject.getTaskManager().emptyClone();
        // ResourceManager resourceManager =
        // project.getHumanResourceManager();
        ResourceManager resourceManager = new HumanResourceManager(bufferProject
        .getRoleManager().getDefaultRole());
        RoleManager roleManager = new RoleManagerImpl();
        GanttXMLOpen opener = new GanttXMLOpen(bufferProject.prjInfos, bufferProject
        .getArea(), taskManager, bufferProject.getUIFacade());
        opener.addTagHandler(opener.getDefaultTagHandler());
        TaskTagHandler taskHandler = new TaskTagHandler(taskManager, opener
        .getContext());
        opener.addTagHandler(taskHandler);
        BlankLineTagHandler blankLineHandler = new BlankLineTagHandler(bufferProject.getUIFacade().getGanttChart());
        opener.addTagHandler(blankLineHandler);
        ResourceTagHandler resourceHandler = new ResourceTagHandler(
        resourceManager, roleManager, bufferProject.getResourceCustomPropertyManager());
        opener.addTagHandler(resourceHandler);
        DependencyTagHandler dependencyHandler = new DependencyTagHandler(
        opener.getContext(), taskManager, myUIFacade);
        opener.addTagHandler(dependencyHandler);
        RoleTagHandler roleHandler = new RoleTagHandler(roleManager);
        opener.addTagHandler(roleHandler);
        opener.addParsingListener(dependencyHandler);
        opener.addParsingListener(resourceHandler);
        AllocationTagHandler allocationHandler = new AllocationTagHandler(
        resourceManager, taskManager, roleManager);
        opener.addTagHandler(allocationHandler);
        opener.addParsingListener(allocationHandler);
        VacationTagHandler vacationHandler = new VacationTagHandler(
        resourceManager);
        opener.addTagHandler(vacationHandler);

        //
        if (bMerge == false) {
        HolidayTagHandler holidayHandler = new HolidayTagHandler(
        bufferProject);

        opener.addTagHandler(holidayHandler);
        opener.addParsingListener(holidayHandler);
        } else {
        opener.isMerging(true);
        }
        opener.load(document.getInputStream());

        bufferProject.getRoleManager().importData(roleManager);
        Map original2ImportedResource = bufferProject.getHumanResourceManager()
        .importData(resourceManager);
        TaskManagerImpl origTaskManager = (TaskManagerImpl) bufferProject.getTaskManager();
        try {
        origTaskManager.setEventsEnabled(false);
        Map original2ImportedTask = origTaskManager.importData(taskManager);
        origTaskManager.importAssignments(
        taskManager,
        bufferProject.getHumanResourceManager(), original2ImportedTask,
        original2ImportedResource);
        }
        finally {
        origTaskManager.setEventsEnabled(true);
        }
        bufferProject.getResourcePanel().getResourceTreeTableModel()
        .updateResources();
         */
    } catch (IOException e) {
        uiFacade.showErrorDialog(e);
    }
}