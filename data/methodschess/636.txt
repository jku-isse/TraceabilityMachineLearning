// Constructors
ControlLayer(GameController controller, PiecesLayer pl) {
    setController(controller);
    _squareSize = ChessBoardRenderer2D.getSquareSize();
    _boardSize = 8 * (_squareSize);
    setLayout(null);
    setOpaque(false);
    setPreferredSize(new Dimension(_boardSize, _boardSize));
    setBounds(0, 0, _boardSize, _boardSize);
    _piecesLayer = pl;
    addMouseListener(new MouseAdapter() {
        public void mouseClicked(MouseEvent e) {
            if ((_sourceSquare) == (-1)) {
                _sourceSquare = (8 * (7 - ((e.getY()) / (_squareSize)))) + ((e.getX()) / (_squareSize));
                repaint();
            } else {
                final int destSquare = (8 * (7 - ((e.getY()) / (_squareSize)))) + ((e.getX()) / (_squareSize));
                new Thread(new Runnable() {
                    public void run() {
                        // The capture flag is added by the game controller(!).
                        getController().userPly(new PlyImpl(new PositionImpl(_sourceSquare), new PositionImpl(destSquare), false));
                        _sourceSquare = -1;
                        repaint();
                    }
                }).start();
                // getController().userPly( new PlyImpl( new PositionImpl( _sourceSquare), new PositionImpl( destSquare)));
                // _sourceSquare = -1;
                // repaint();
            }
        }
    });
}