public void LoadFile(InputStream fileContent, DAOFactory factory, EventLoggingAction loggingAction, long loggedInMID) throws DBException, IOException {
    NDCodesDAO ndcodesDAO = factory.getNDCodesDAO();
    Scanner fileScanner = new Scanner(fileContent);
    while (fileScanner.hasNextLine()) {
        String ndCodeWithDash;
        MedicationBean bean = new MedicationBean();
        StringTokenizer tok = new StringTokenizer(fileScanner.nextLine(), "	");
        ndCodeWithDash = tok.nextToken();
        String[] parts = ndCodeWithDash.split("-");
        // Skip drug type field
        tok.nextToken();
        bean.setNDCode(parts[0].concat(parts[1]));
        bean.setDescription(tok.nextToken());
        try {
            ndcodesDAO.addNDCode(bean);
            loggingAction.logEvent(TransactionType.DRUG_CODE_ADD, loggedInMID, 0, ((("" + (bean.getNDCode())) + " - ") + (bean.getDescription())));
        } catch (Exception e) {
            // Overwrite duplicate entries
            ndcodesDAO.updateCode(bean);
            loggingAction.logEvent(TransactionType.DRUG_CODE_EDIT, loggedInMID, 0, ((("" + (bean.getNDCode())) + " - ") + (bean.getDescription())));
        }
    } 
}