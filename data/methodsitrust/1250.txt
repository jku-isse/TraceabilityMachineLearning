/**
 * Returns all the prescriptions for a given patient
 *
 * @param patientID
 * 		patient in question
 * @return list of all the prescriptions for that patient
 * @throws iTrustException
 * 		
 */
public List<PrescriptionBean> getPrescriptionsForPatient(long patientID) throws iTrustException {
    PatientBean patient = patientDAO.getPatient(patientID);
    if ((loggedInMID) == patientID) {
        return patientDAO.getPrescriptions(patientID);
    }
    List<String> toList = new ArrayList<String>();
    toList.add(patient.getEmail());
    List<PatientBean> representatives = patientDAO.getRepresenting(patientID);
    for (PatientBean representative : representatives) {
        if ((loggedInMID) == (representative.getMID())) {
            return patientDAO.getPrescriptions(patientID);
        }
        toList.add(representative.getEmail());
    }
    List<PersonnelBean> dlhcps = patientDAO.getDeclaredHCPs(patientID);
    for (PersonnelBean dlhcp : dlhcps) {
        if ((loggedInMID) == (dlhcp.getMID())) {
            return patientDAO.getPrescriptions(patientID);
        }
        List<PersonnelBean> uaps = personnelDAO.getUAPsForHCP(dlhcp.getMID());
        for (PersonnelBean uap : uaps) {
            if ((loggedInMID) == (uap.getMID())) {
                return patientDAO.getPrescriptions(patientID);
            }
        }
    }
    Email email = new Email();
    email.setToList(toList);
    email.setFrom("noreply@itrust.com");// $NON-NLS-1$

    email.setSubject(Messages.getString("ViewPrescriptionRecordsAction.1"));// $NON-NLS-1$

    email.setBody(Messages.getString("ViewPrescriptionRecordsAction.2"));// $NON-NLS-1$

    emailer.sendEmail(email);
    return patientDAO.getPrescriptions(patientID);
}