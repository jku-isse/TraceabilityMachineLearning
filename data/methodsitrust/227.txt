public void testDeclareAlreadyDeclared() throws Exception {
    try {
        action.declareHCP("9000000003");
        fail("exception should have been thrown");
    } catch (iTrustException e) {
        assertEquals("HCP 9000000003 has already been declared for patient 2", e.getMessage());
    }
    List<PersonnelBean> decs = action.getDeclaredHCPS();
    assertEquals(1, decs.size());
    assertEquals(9000000003L, decs.get(0).getMID());
    // Assert the transaction
    List<TransactionBean> transList = factory.getTransactionDAO().getAllTransactions();
    assertEquals(0, transList.size());
}