/**
 * Send messages to the users associated with creating a referral.
 *
 * @param bean
 * 		
 * @throws Exception
 * 		
 */
public void sendReferralCreatedMessages(ReferralBean bean) throws Exception {
    StringBuilder body = new StringBuilder();
    body.append("Referral information:
");
    String senderSpecialty = personnelDAO.getPersonnel(bean.getSenderID()).getSpecialty();
    String receiverSpecialty = personnelDAO.getPersonnel(bean.getReceiverID()).getSpecialty();
    senderSpecialty = (senderSpecialty == null) ? "no specialty" : senderSpecialty;
    receiverSpecialty = (receiverSpecialty == null) ? "no specialty" : receiverSpecialty;
    body.append((((("Sending HCP: " + (personnelDAO.getName(bean.getSenderID()))) + " (") + senderSpecialty) + ")
"));
    body.append((((("Receiving HCP: " + (personnelDAO.getName(bean.getReceiverID()))) + " (") + receiverSpecialty) + ")
"));
    body.append((("Patient: " + (getPatientName(bean))) + "
"));
    body.append((("Notes: " + (bean.getReferralDetails())) + "
"));
    body.append((("Created on: " + (bean.getTimeStamp())) + "
"));
    MessageBean senderMsg = new MessageBean();
    senderMsg.setFrom(bean.getSenderID());
    senderMsg.setTo(bean.getSenderID());
    senderMsg.setBody(body.toString());
    senderMsg.setSubject("You Created a New Referral");
    senderMsg.setRead(0);
    messageAction.sendMessage(senderMsg);
    MessageBean receiverMsg = new MessageBean();
    receiverMsg.setFrom(bean.getSenderID());
    receiverMsg.setTo(bean.getReceiverID());
    receiverMsg.setBody(body.toString());
    receiverMsg.setSubject("You Received a New Referral");
    receiverMsg.setRead(0);
    messageAction.sendMessage(receiverMsg);
    MessageBean patientMsg = new MessageBean();
    patientMsg.setFrom(bean.getSenderID());
    patientMsg.setTo(bean.getPatientID());
    patientMsg.setBody(body.toString());
    patientMsg.setSubject("You Received a New Referral");
    patientMsg.setRead(0);
    messageAction.sendMessage(patientMsg);
}