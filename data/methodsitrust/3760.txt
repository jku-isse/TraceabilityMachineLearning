public void testEditApptConflictCancel() throws Exception {
    gen.uc22();
    // Login
    WebConversation wc = login("9000000000", "pw");
    WebResponse wr = wc.getCurrentPage();
    wr = wr.getLinkWith("View My Appointments").click();
    TableRow[] rows = wr.getTableStartingWithPrefix("Patient").getRows();
    DateFormat format = new SimpleDateFormat("MM/dd/yyyy hh:mm a");
    DateFormat format2 = new SimpleDateFormat("MM/dd/yyyy");
    Calendar c = Calendar.getInstance();
    c.add(Calendar.DATE, 12);
    c.set(Calendar.HOUR, 9);
    c.set(Calendar.AM_PM, Calendar.AM);
    c.set(Calendar.MINUTE, 45);
    String date = format.format(c.getTime());
    int rowIndex = 0;
    for (TableRow row : rows) {
        if ((row.getText().contains(date)) && (row.getText().contains("Random Person"))) {
            break;
        }
        rowIndex++;
    }
    wr = wr.getTableStartingWithPrefix("Patient").getTableCell(rowIndex, 5).getLinkWith("Edit").click();
    c.add(Calendar.DATE, (-5));
    c.set(Calendar.HOUR, 1);
    c.set(Calendar.AM_PM, Calendar.PM);
    c.set(Calendar.MINUTE, 45);
    WebForm apptForm = wr.getForms()[0];
    apptForm.setParameter("apptType", "General Checkup");
    apptForm.setParameter("schedDate", format2.format(c.getTime()));
    apptForm.setParameter("time1", "01");
    apptForm.setParameter("time2", "45");
    apptForm.setParameter("time3", "PM");
    apptForm.getSubmitButton("editApptButton", "Change").click();
    wr = wc.getCurrentPage();
    assertTrue(wr.getText().contains("Warning"));
    iTrustHTTPTest.assertNotLogged(TransactionType.APPOINTMENT_ADD, 9000000000L, 1L, "");
    apptForm = wr.getForms()[0];
    apptForm.setParameter("apptType", "General Checkup");
    apptForm.setParameter("schedDate", format2.format(c.getTime()));
    apptForm.setParameter("time1", "02");
    apptForm.setParameter("time2", "00");
    apptForm.setParameter("time3", "PM");
    apptForm.getSubmitButton("editApptButton", "Change").click();
    wr = wc.getCurrentPage();
    assertFalse(wr.getText().contains("Warning"));
    iTrustHTTPTest.assertLogged(TransactionType.APPOINTMENT_EDIT, 9000000000L, 1L, "");
}