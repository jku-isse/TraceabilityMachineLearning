/**
 * Test add prescription for scenario 4
 *
 * @throws Exception
 * 		
 */
public void testAddPrescription4() throws Exception {
    action = new EditPrescriptionsAction(factory, 9000000000L, "1", "11");
    assertEquals(0, action.getPrescriptions().size());
    PrescriptionBean bean = new PrescriptionBean();
    MedicationBean med = factory.getNDCodesDAO().getNDCode("678771191");
    bean.setMedication(med);
    bean.setDosage(10);
    bean.setStartDateStr("01/31/2011");
    bean.setEndDateStr("02/12/2011");
    bean.setInstructions("Take as needed");
    bean.setVisitID(11);
    action.addPrescription(bean);
    assertEquals(1, action.getPrescriptions().size());
    med = factory.getNDCodesDAO().getNDCode("081096");
    bean.setMedication(med);
    bean.setDosage(10);
    bean.setStartDateStr("01/31/2011");
    bean.setEndDateStr("02/12/2011");
    bean.setInstructions("Take as needed");
    bean.setVisitID(11);
    try {
        action.addPrescription(bean);
        fail("Expected a PrescriptionWarningException.");
    } catch (PrescriptionWarningException e) {
        assertTrue(e.getDisplayMessage().contains("Currently Prescribed: Ibuprofen"));
    }
}