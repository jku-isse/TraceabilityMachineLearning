public void testChangePassword() throws Exception {
    WebConversation wc = login("2", "pw");
    WebResponse wr = wc.getCurrentPage();
    iTrustHTTPTest.assertLogged(TransactionType.HOME_VIEW, 2L, 0L, "");
    wr = wr.getLinkWith("Logout").click();
    iTrustHTTPTest.assertLogged(TransactionType.LOGOUT, 2L, 2L, "");
    assertEquals("iTrust - Login", wr.getTitle());
    wr = wr.getLinkWith("Reset Password").click();
    WebForm wf = wr.getForms()[1];
    wf.setParameter("role", "patient");
    wf.setParameter("mid", "2");
    wr = wf.submit();
    wf = wc.getCurrentPage().getForms()[1];
    wf.setParameter("answer", "good");
    wf.setParameter("password", "password2");
    wf.setParameter("confirmPassword", "password2");
    wr = wf.submit();
    assertTrue(wr.getText().contains("Password changed"));
    iTrustHTTPTest.assertLogged(TransactionType.PASSWORD_RESET, 2L, 2L, "");
    wc = login("2", "pw");
    wr = wc.getCurrentPage();
    assertTrue(wr.getText().contains("Failed login"));
    wc = login("2", "password2");
    wr = wc.getCurrentPage();
    iTrustHTTPTest.assertLogged(TransactionType.HOME_VIEW, 2L, 0L, "");
    assertTrue(wr.getTitle().equals("iTrust - Patient Home"));
}