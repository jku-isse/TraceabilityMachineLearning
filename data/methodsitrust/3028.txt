public long getNextID(Role role) throws DBException, iTrustException {
    Connection conn = null;
    PreparedStatement ps = null;
    // long newID = 9000000000L;
    long minID = (role.getMidFirstDigit()) * 1000000000L;
    minID = (minID == 0) ? 1 : minID;// Do not use 0 as an ID.

    long maxID = minID + 999999998L;
    long nextID = minID;
    try {
        conn = factory.getConnection();
        ps = conn.prepareStatement("SELECT MAX(users.mid) FROM users WHERE mid BETWEEN ? AND ?");
        ps.setLong(1, minID);
        ps.setLong(2, maxID);
        ResultSet rs = ps.executeQuery();
        if (rs.next()) {
            nextID = (rs.getLong(1)) + 1;
            if (nextID < minID) {
                nextID = minID;
            }
        }
        return nextID;
    } catch (SQLException e) {
        e.printStackTrace();
        throw new DBException(e);
    } finally {
        DBUtil.closeConnection(conn, ps);
    }
}