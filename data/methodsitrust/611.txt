public void testGetVisitReminders_CorrectDateOfRecentVisit() throws Exception {
    gen.hcp0();
    gen.aliveRecurringPatients();
    action = new GetVisitRemindersAction(factory, 9000000000L);
    SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
    Calendar twoYrsAgo = Calendar.getInstance();
    twoYrsAgo.add(Calendar.YEAR, (-2));
    List<VisitReminderReturnForm> vReminders = action.getVisitReminders(GetVisitRemindersAction.ReminderType.DIAGNOSED_CARE_NEEDERS);
    String date = "";
    for (VisitFlag vf : vReminders.get(0).getVisitFlags()) {
        if (vf.getType().equals(VisitFlag.LAST_VISIT)) {
            date = vf.getValue();
        }
    }
    assertEquals(sdf.format(twoYrsAgo.getTime()), date);
}